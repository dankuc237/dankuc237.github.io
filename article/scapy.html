<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<link rel="stylesheet" href="/_assets/main.css" />

    <title>SCAPY - site name</title>
  <link rel="stylesheet" href="/_markdown_plugin_assets/highlight.js/atom-one-light.css" /></head>
  <body>
    <div class="main">
      <nav class="navigation">
        <a href="/">site name</a>
      </nav>
      <article>
        <header>
          <h1 class="article-title">SCAPY</h1>
          <div class="article-info">
            <div>
              <span
                >Created At：<time datetime="1660209890415"
                  >2022-08-11 05:24</time
                ></span
              >
              <span
                >Updated At：<time datetime="1660210891819"
                  >2022-08-11 05:41</time
                ></span
              >
            </div>
            
          </div>
        </header>
        <div class="article-content markdown-body"><p><strong>Scapy</strong> is a Python library and standalone program that enables users to send, sniff, dissect, and forge network packets. It can be installed using pip or the relevant package manager for your platform. We can scan, traceroute, probe, attack, and discover networks using Scapy. Imagine replacing hping, arpspoof, arping, tcpdump, tshark, p0f, and most of nmap with just one program.</p>
<p>Build own tool to identify another user’s known Wi‑Fi networks by detecting probe requests to search for and find any of the wireless networks in list of preferred networks that contains the names of wireless networks the device has connected to in the past.</p>
<div><pre class="hljs"><code><span class="hljs-comment"># put card in monitor mode</span>
$ airmon-ng<span class="hljs-built_in"> check </span>kill
$ airmon-ng start wlan0
<span class="hljs-comment"># tworzę skrypt w pythonie do sniffowania pakietów sniff_probe_request.py</span>
from scapy.all import *
interface=<span class="hljs-string">"wlan0mon"</span>
probeRequests=[]

def probeSniff(pkt):
   <span class="hljs-built_in"> if </span>pkt.haslayer(Dot11ProbeReq):
        networkName=pkt.getlayer(Dot11ProbeReq).info
       <span class="hljs-built_in"> if </span>networkName<span class="hljs-built_in"> not </span>in probeRequests:
            probeRequests.append(networkName)
            print(f<span class="hljs-string">"New probe request: {str(networkName)}"</span>)

sniff(iface=interface,prn=probeSniff)</code></pre></div>
<p>We begin by identifying our wireless network interface card and putting it into monitor mode with airmon. Next, we install Scapy using apt, but it can be installed using pip. We now create a Python script file called sniff_probe_requests.py and import the Scapy library. The variable interface holds the name of our wireless interface that is now in monitor mode, and we create an empty list of probeRequests. Let’s now create a function that sniffs packets on the wireless networks and which tries to identify probeRequests. The function receives a packet, pkt. We then dissect the packet to identify if it has a .11 probeRequests layer with the haslayer method. If the packet is a probe request, then we extract the network name from the info property of the packet’s getlayer method. There’s no point in recording this probe request if we’ve already seen it, so first we check to see if it’s in the probeRequests list, and if not, we append it to the list. Having detected a new probe request and added it to our list, we print the requested network named to screen. Finally we use Scapy’s sniff function, passing it the name of our wireless monitoring interface and the destination for any detected packets, which is our probeSniff function. Let’s run our script and see what we get. Since we rely on devices that have either been rebooted or disconnected from a Wi‑Fi network, it may take some time to see results. But imagine sitting in a public space where passersby have disconnected from their home or work networks, and their phones or laptops are actively seeking a known network to connect to. In the face of it, this seems harmless, but this is a massive breach of confidentiality. With a few lines of code, you may be able to identify where someone works, where they shop, where they socialize, which major transport hubs they use, the hotels they’ve stayed at, and more. This information could be invaluable for a subsequent social engineering attack.</p>
</div>
      </article>
    </div>
  </body>
</html>
